--[[ 
  LocalScript Template - Player Controller
  Colocar em: StarterPlayerScripts
]]

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local root = character:WaitForChild("HumanoidRootPart")

-- CONFIGURAÇÕES INICIAIS
local settings = {
    WalkSpeed = 200,   -- Padrão Roblox
    JumpPower = 100,   -- Padrão Roblox
    HipHeight = humanoid.HipHeight,
    Gravity = workspace.Gravity,
    FlySpeed = 50,
    Noclip = false,
    Fly = true,
}

-- FUNÇÃO PARA ATUALIZAR STATS
local function updateStats()
    humanoid.WalkSpeed = settings.WalkSpeed
    humanoid.JumpPower = settings.JumpPower
    humanoid.HipHeight = settings.HipHeight
    workspace.Gravity = settings.Gravity
end

-- CHAMAR AO INICIAR
updateStats()

-- FUNÇÃO NOCIP
local function noclipLoop()
    while settings.Noclip do
        RunService.Stepped:Wait()
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end

-- FUNÇÃO FLY
local function flyLoop()
    local bodyVelocity
    if settings.Fly then
        bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(1e5, 1e5, 1e5)
        bodyVelocity.Velocity = Vector3.new(0,0,0)
        bodyVelocity.Parent = root
    end

    while settings.Fly do
        RunService.RenderStepped:Wait()
        local moveDir = Vector3.new()
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + workspace.CurrentCamera.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - workspace.CurrentCamera.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - workspace.CurrentCamera.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + workspace.CurrentCamera.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDir = moveDir + Vector3.new(0,1,0) end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveDir = moveDir - Vector3.new(0,1,0) end
        bodyVelocity.Velocity = moveDir.Unit * settings.FlySpeed
    end

    if bodyVelocity then
        bodyVelocity:Destroy()
    end
end

-- INPUTS PARA TESTE
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    if input.KeyCode == Enum.KeyCode.N then
        settings.Noclip = not settings.Noclip
        if settings.Noclip then
            noclipLoop()
        end
    elseif input.KeyCode == Enum.KeyCode.F then
        settings.Fly = not settings.Fly
        flyLoop()
    end
end)

-- FUNÇÃO RESET STATS
local function resetStats()
    settings.WalkSpeed = 16
    settings.JumpPower = 50
    settings.HipHeight = humanoid.HipHeight
    settings.Gravity = 196.2
    settings.Noclip = false
    settings.Fly = false
    updateStats()
end

-- COMANDOS SIMPLES PELO CHAT
player.Chatted:Connect(function(msg)
    local args = msg:split(" ")
    if args[1] == ";ws" and args[2] then
        settings.WalkSpeed = tonumber(args[2]) or settings.WalkSpeed
        updateStats()
    elseif args[1] == ";jp" and args[2] then
        settings.JumpPower = tonumber(args[2]) or settings.JumpPower
        updateStats()
    elseif args[1] == ";reset" then
        resetStats()
    end
end)

print("Player Controller Template Loaded!")
